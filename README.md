# Wall-to-Wall Above-ground Biomass Estimation with ALOS-2 PALSAR-2 L-Band SAR Data and GEDI

## This work is accepted in IEEE International Symposium on Geoscience and Remote Sensing (IGARSS) 2023 
## DOI: 10.1109/IGARSS52108.2023.10282061
## Repo Structure
    .
    ├── config                                     # Configuration files 
    │   ├── pre_strata_matrix.yml                  # Allometric models parameters 
    ├── figure                                     # Figures used in README 
    ├── gedi_palsar_data                           # Downloaded GEDI-PALSAR GeoTIFF
    ├── GEDIClient                                 # Client to download GEDI L4A footprint from the official source (Not in use)
    ├── gedi_train_sample_json                     # Training samples GeoJSON
    ├── satellites                                 # Main Google Earth Engine Client to download and process satellite images
    │   ├── GEDI.py                                # Google Earth Engine Client to download and process GEDI images
    ├── main_gedi_client.py                        # Main file to use GEDI Client (Not in use)
    ├── main_gedi_palsar_download.py               # Main file to prepare and generate dataset, inference
    ├── run_cnn_model_gedi.py                      # Main file for deep learning model
    ├── ParamsFetching.py                          # Apply allometric models to GEDI L2A to GEDI L4A (Not in use)
    └── README.md
This repo intends to use PALSAR-2 L-Band SAR data with the assistance of GEDI Level-2 Relative Heights (RH) data to generate 
wall-to-wall estimations of large scale AGB estimations. 

## Background

NASA Global Ecosystem Dynamics Investigation (GEDI) mission is the first high-resolution laser ranging observation on the 3D 
structure of the Earth, which precisely measures the forest canopy height, canopy vertical structure, and surface elevation.
From the forest canopy height, AGB can be obtained by using allometric models of different regions. 
GEDI L2A data is a footprint level Relative Heights (RH) product which measures ground tree heights. 
From L2A data, L4A AGB data can be generated by using allometric models. However, the major challenge of GEDI based AGB 
estimation is that GEDI data is sparse since it only samples about 4% of the Earth’s land surface between 51.6° N&S. So in this
work, we aim to map PALSAR-2 L-Band SAR data to AGB using Deep Learning. L-Band has significantly higher penetration capability and
can interact with surface layers, trunks, and stems which is more suitable than other wavelength in measuring AGB. By using 
large scale data, we aim to find the mapping between PALSAR-2 data and GEDI L4A footprint AGB data. So by applying the model to
the wall-to-wall PALSAR-2 data, large scale continuous AGB data can be generated.

## Methodology

![Alt text](figure/methods.svg?raw=true "Methodology")

We propose using ConvNet with U-Net style architecture as the solution. Unlike U-Net, the last layer is changed to linear 
activation since the model is applied to a regression problem. The loss function is then changed to masked mean squared error 
because the label GEDI L4A AGB data is in footprint level. So the loss is only calculated where the L4A footprint is available.
As an auxiliary data, GEDI L2A RH data is fused with PALSAR-2 at input level. 

## Results
![Alt text](figure/waux.svg?raw=true "Title")
![Alt text](figure/woaux.svg?raw=true "Title")

On the left hand side, is the result with 100% GEDI L2A RH data, on the right hand side, is the result only using PALSAR-2 data.

## Author

#### Yu Zhao (zhao2@kth.se), Xin Guo, Liheng Zhong, Jian Wang, JingDong Chen, Ant Group, Hangzhou, China

## Acknowledgement
#### Work is done during intership at Ant Group
